<!doctype html>
<html lang="en" prefix="og: http://ogp.me/ns#">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- SEO -->
    <title>Practical Machine Learning with Python</title>
    <meta name="description" content="Learn how to do some Practical Machine Learning with Python!">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,700,700i%7CMaitree:200,300,400,600,700&amp;subset=latin-ext" rel="stylesheet">

    <!-- CSS Base -->
    <link rel="stylesheet" type='text/css' media='all' href="static/css/base.css">

    <!-- CSS Colors -->
    <link rel="stylesheet" type='text/css' media='all' href="static/css/colors.css">

    <!-- Optional - CSS SVG Icons (Font Awesome) -->
    <link rel="stylesheet" type='text/css' media='all' href="static/css/svg-icons.css">
    
    <!-- Asset Preloads -->
    <link rel="preload" href="images/paul-285358.jpg" as="image">
    <link rel="preload" href="images/william-bout-264826.jpg" as="image">
    <link rel="preload" href="images/drew-hays-206414.jpg" as="image">
    <link rel="preload" href="images/pietro-jeng-266017.jpg" as="image">
    <link rel="preload" href="images/php.png" as="image">
    <link rel="preload" href="images/js.png" as="image">
    <link rel="preload" href="images/java.png" as="image">
    <link rel="preload" href="images/fullbody.jpg" as="image">
    <link rel="preload" href="images/face1.jpg" as="image">
    <link rel="preload" href="images/face2.jpg" as="image">
  </head>
  <body>
    <header role="banner">
      <nav role="navigation">
        <p class="logo"><a href="index.html" title="Practical Machine Learning with Python">Practical Machine Learning with Python</a></p>
        <ul>
          <li class="github">
            <a rel="external" href="https://github.com/johnpaulada/ml-talk-slides" title="Github">
              <svg class="fa-github">
                <use xlink:href="#fa-github"></use>
              </svg>
              <em>Practical Machine Learning with Python Slides</em>
            </a>
          </li>
          <li class="github">
            <a rel="external" href="https://github.com/johnpaulada/emotion-detection-docker" title="Github">
              <svg class="fa-github">
                <use xlink:href="#fa-github"></use>
              </svg>
              <em>Emotion Detection App and Docker Image</em>
            </a>
          </li>
        </ul>
      </nav>
    </header>

    <main role="main">
      <article id="webslides" class="vertical">

        <!-- Slide #1 - Title Slide -->
        <section class="bg-black-blue">
          <span class="background anim dark" style="background-image: url(images/paul-285358.jpg); background-size: cover;"></span>
          <div class="wrap aligncenter">
            <h1 class="text-landing">Practical Machine Learning <br> with Python</h1>
            <p class="text-subtitle">by John Paul Ada</p>
            <p class="text-intro">Build an emotion detection program from (almost) scratch.</p>
          </div>
        </section>

        <!-- Slide #2 - Who am I? -->
        <section class="bg-gradient-h">
          <div class="wrap aligncenter">
            <h1 class="text-landing">Who am I?</h1>
          </div>
        </section>

        <!-- Slide #3 - John Paul Ada -->
        <section class="fullscreen">
          <div class="card-50">
            <div class="flex-content">
              <div class="wrap aligncenter">
                <br> <br>
                <h1 class="text-landing">John Paul Ada</h1> <br>
                <p class="text-subtitle">Full Stack Web &amp; Mobile Developer @ GAPLabs<br>BA Psychology Graduate (UP Tacloban)</p>
              </div>
            </div>
            <figure>
              <img src="images/fullbody.jpg" alt="John Paul Ada Grad Pic">
            </figure>
          </div>
        </section>

        <!-- Slide #4 - Stack -->
        <section>
          <div class="wrap">
            <h1 class="text-context">My Stack</h1>
            <p class="text-subtitle">Libraries &amp; frameworks not included</p>
            <hr>
            <ul class="flexblock gallery">
              <li>
                <a href="#">
                  <figure>
                    <img src="images/python.png" alt="Python Logo">
                    <figcaption>
                      <h2>Python</h2>
                      <p>My go-to language for automation and machine learning. This is what we'll be using on today.</p>
                    </figcaption>
                  </figure>
                </a>
              </li>
              <li>
                <a href="#">
                  <figure>
                    <img src="images/js.png" alt="JS Logo">
                    <figcaption>
                      <h2>Javascript</h2>
                      <p>My favorite language for web, mobile, and desktop app development &mdash; because FP is cool.</p>
                    </figcaption>
                  </figure>
                </a>
              </li>
              <li>
                <a href="#">
                  <figure>
                    <img src="images/php.png" alt="PHP Logo">
                    <figcaption>
                      <h2>PHP</h2>
                      <p>My de-facto choice for REST &amp; GraphQL API development.</p>
                    </figcaption>
                  </figure>
                </a>
              </li>
              <li>
                <a href="#">
                  <figure>
                    <img src="images/console.png" alt="Console Logo">
                    <figcaption>
                      <h2>Others</h2>
                      <p>I also use SQL (of course), C, Java, Linux Bash, a little Go and Elixir, etc.</p>
                    </figcaption>
                  </figure>
                </a>
              </li>
            </ul>
          </div>
        </section>

        <!-- Slide #5 - Tech Activities -->
        <section>
          <div class="wrap size-50">
            <h1 class="text-context">My Tech Activities</h1>
            <hr>
            <div class="bg-white shadow">
              <ul class="flexblock reasons">
                <li>
                  <h2>Tech Talks</h2>
                  <p>I share what I know on a variety of topics at tech meetups (PD, Dev8, etc.) and in schools.</p>
                </li>
                <li>
                  <h2>Tech Blogging</h2>
                  <p>I blog about tech and other things @ <a href="https://medium.com/@jepedesu">Medium</a> and <a href="https://dev.to/johnpaulada">The Practical Dev</a>.</p>
                </li>
                <li>
                  <h2>Tech Podcasting</h2>
                  <p>My podcast is called the Random Programmer and is currently in episode 3. You can listen to it in <a href="https://anchor.fm/john-paul-nuguit-ada">Anchor</a>, <a href="https://play.google.com/music/listen?t=The_Random_Programmer&pcampaignid=MKT-&u=0&view=/ps/I6haesi2y6hrpq44slep5eu5yum">Google Play Music</a>, <a href="https://itunes.apple.com/us/podcast/the-random-programmer/id1266671018?mt=2">Apple Podcasts</a>, <a href="http://pca.st/xnUL">Pocket Casts</a>, and <a href="https://overcast.fm/itunes1266671018/the-random-programmer">Overcast</a>.</p>
                </li>
                <li>
                  <h2>Project Development</h2>
                  <p>I do personal projects from time to time. You can see them at <a href="https://github.com/johnpaulada">Github</a>.</p>
                </li>
              </ul>
            </div>
          </div>
        </section>

        <!-- Slide #6 - My Machine Learning Process -->
        <section>
          <div class="wrap">
            <h1 class="text-context">My Machine Learning Process</h1>
            <hr>
            <ul class="flexblock steps">
              <li>
                <h2>State your goal</h2>
                <p>As with any scientific process, there must be a goal in mind.</p>
              </li>
              <li>
                <div class="process step-2"></div>
                <h2>Get good data</h2>
                <p>Machine Learning is all about data. You need to get good data to get good results.</p>
              </li>
              <li>
                <div class="process step-3"></div>
                <h2>Prepare the data</h2>
                <p>Sometimes the data you get is not yet usable, so you have to process it to prepare it for use.</p>
              </li>
              <li>
                <div class="process step-4"></div>
                <h2>Feature research</h2>
                <p>Research about which features of the thing being learned is best and can be used.</p>
              </li>
            </ul>
            <ul class="flexblock steps">
              <li>
                <h2>Feature extraction and preprocessing</h2>
                <p>Actually get the features from the data and preprocess the data to prepare for processing by the machine learning algorithm.</p>
              </li>
              <li>
                <div class="process step-2"></div>
                <h2>Algorithm research &amp; selection</h2>
                <p>Research and choose the algorithms you can use for the problem.</p>
              </li>
              <li>
                <div class="process step-3"></div>
                <h2>Train &amp; evaluate model</h2>
                <p>Train a mathematical model with the chosen algorithm and the gathered data and evaluate it to see if it achieves your goal.</p>
              </li>
              <li>
                <div class="process step-4"></div>
                <h2>Save &amp; use model</h2>
                <p>Save the model and use it for later.</p>
              </li>
            </ul>
          </div>
        </section>

        <!-- Slide #7 - Prerequisites -->
        <section>
          <h1 class="content-center">Prerequisites</h1>
          <hr>
          <div class="wrap">
            <div class="grid">
              <div class="column">
                <h2>With Docker (<em>Recommended</em>)</h2>
                <ol>
                  <li>Install Docker</li>
                  <li>Run <code>git clone https://github.com/johnpaulada/emotion-detection-docker.git</code> in your console</li>
                  <li>Run <code>cd emotion-detection-py</code> in your console</li>
                  <li>Run <code>docker pull johnpaulada/emotion-detection</code> or <code>docker load -i emotion-detection.tar</code>in your console</li>
                  <li>Run <code>docker run -v `pwd`/app:/home/app -it johnpaulada/emotion-detection</code> in your console</li>
                  <li>Run <code>cd app</code> in your console</li>
                  <li>You're all set!</li>
                </ul>
              </div>
              <div class="column">
                <h2>Manual Install</h2>
                <ol>
                  <li>Install Python</li>
                  <li>Install Pip</li>
                  <li>Install Numpy</li>
                  <li>Install scikit-learn</li>
                  <li>Install OpenCV</li>
                  <li>Install dlib</li>
                  <li>Install imutils</li>
                  <li>Run <code>git clone https://github.com/johnpaulada/emotion-detection-docker.git</code> in your console</li>
                  <li>Run <code>cd emotion-detection-py</code> in your console</li>
                  <li>Run <code>docker run -v `pwd`/app:/home/app -it johnpaulada/emotion-detection</code> in your console</li>
                  <li>You're all set!</li>                  
                </ol>
              </div>
            </div>
          </div>
        </section>

        <!-- Slide #8 - Goal -->
        <section class="fullscreen">
          <div class="card-50">
            <figure>
              <img src="images/face1.jpg" alt="Man Face">
            </figure>
            <div class="flex-content">
              <h1 class="text-context">The Goal</h1>
              <br>
              <p>The goal here is to create a program that can read the emotions of faces present in images. <br>
                We don't have to tell a machine what makes a happy face or a sad face. <br>
                It can figure it out on its own from the data given to it. <br>
                Because of that we need to get some data.
              </p>
            </div>
          </div>
        </section>

        <!-- Slide #9 - Good Data -->
        <section class="bg-white aligncenter">
          <span class="background dark" style="background-image:url(images/face2.jpg)"></span>
          <div class="wrap">
            <h1 class="text-landing" style="font-size: 64pt;"><strong>Good Data</strong></h1>
            <hr>
            <h4 class="text-serif">Good data is needed to get good results in Machine Learning. <br>
              In this case we need to get a wide variety of faces and emotions. This is so we can avoid <strong>overfitting</strong>. <br>
              This makes sure that our program can recognize emotion from a face it has not seen before. <br>
              For this problem, I downloaded a bunch of different photos from <strong>Google</strong> that shows 4 types of emotions:<br>
              <em>Angry, Sad, Neutral, and Happy</em>
            </h4>
          </div>
        </section>

        <!-- Slide #10 - Feature Research -->
        <section class="fullscreen">
          <div class="card-50">
            <figure>
              <img src="images/drew-hays-206414.jpg" alt="Man Face">
            </figure>
            <div class="flex-content">
              <h1 class="text-context">Feature Research</h1>
              <br>
              <p>To help a machine learn well, we need to get the relevant features of our data.<br>
                When we say features, they're literally the features of, for example, a face. <br>
                An example feature would be the color of the eyes, skin complexion, etc. <br>
                Not all features are relevant. <br>
                Of course, the color of the eyes has nothing to do with our emotions. <br>
                In order to get the relevant questions, we need to ask the right questions.
              </p>
            </div>
          </div>
        </section>

        <!-- Slide #11 - Feature Question -->
        <section class="bg-primary">
          <div class="wrap size-50">
            <blockquote class="text-quote">
              <p>How do I know what a person is feeling from their face?</p>
              <p><cite><a href="https://twitter.com/jepedesu">@jepedesu</a></cite></p>
            </blockquote>
          </div>
        </section>

        <!-- Slide #12 - Face with features written -->
        <section class="fullscreen">
          <div class="card-50">
            <div class="flex-content">
              <div class="wrap aligncenter">
                <br> <br>
                <h1 class="text-landing">Chosen Features</h1> <br>
                <p class="text-subtitle">I chose to get the lines between points in the <strong>lips</strong>, <strong>eyes</strong>, and <strong>eyebrows</strong>. I then get the <strong>lengths</strong> and <strong>angles</strong> of these lines.</p>
              </div>
            </div>
            <figure>
              <!-- TODO: Change this image -->
              <img src="images/rheena-dots.jpg" alt="Rheena Face Dots">
            </figure>
          </div>
        </section>

        <!-- Slide #13 - Feature Extraction -->
        <section class="bg-black aligncenter">
          <span class="background dark" style="background-image:url(images/william-bout-264826.jpg)"></span>
          <div class="wrap">
            <h3 class="text-landing" style="font-size: 64pt;">Feature Extraction</h3>
            <hr>
            <h4 class="text-serif">
              To get these points, I use a library called <code>dlib</code> and a custom face shape descriptor.<br>
            </h4>
          </div>
        </section>

        <!-- Slide #14 - Algorithm Research -->
        <section class="bg-black aligncenter">
          <span class="background dark" style="background-image:url(images/pietro-jeng-266017.jpg)"></span>
          <div class="wrap">
            <h3 class="text-landing" style="font-size: 64pt;">Algorithm Research</h3>
            <hr>
            <h4 class="text-serif">For this problem, my criteria for algorithm selection was that it has to be a classifcation algorithm<br>
              that is able to learn <strong>complicated</strong> relationships, <strong>quick</strong> learning time, and has <strong>good accuracy</strong>.<br>
              Fortunately, Microsoft has a nice little <a href="static/microsoft-machine-learning-algorithm-cheat-sheet-v6.pdf">cheatsheet</a> to help us with that.</h4>
          </div>
        </section>

        <!-- Slide #16 - Preprocessing --> 
        <section>
          <div class="wrap">
            <h1 class="text-context">Preprocessing</h1>
            <hr>
            <ul class="flexblock steps">
              <li>
                <div></div>
                <h2>Extracted Data</h2>
                <p>The data extracted from the images, i.e. line lengths and line angles.</p>
              </li>
              <li>
                <div class="process step-2"></div>
                <h2>Normalization</h2>
                <p>Normalization transforms the features into numbers that are <strong>between 0 and 1</strong> or <strong>between -1 and 1</strong>.
                  This makes it easier for the program to process the numbers because they're in a
                  predictable and computer-friendly range.
                </p>
              </li>
              <li>
                <div class="process step-3"></div>
                <h2>Feature Selection</h2>
                <p>Only useful features that contribute greatly to the detection are selected, according to previous data.
                  This allows for better training and prediction performance and accuracy because the program only processes features that
                  are useful and forgets the less useful ones.</p>
              </li>
            </ul>
          </div>
        </section>

        <!-- Slide #17 - Train & Evaluate Model -->
        <section>
          <div class="wrap">
            <h1 class="text-context">Training and Evaluation</h1>
            <hr>
            <ul class="flexblock steps">
              <li>
                <div></div>
                <h2>Algorithm Selection</h2>
                <p>After doing research, a collection of algorithms deemed most suited to the job are selected.
                </p>
              </li>
              <li>
                <div></div>
                <div class="process step-2"></div>
                <h2>Hyperparameter Tuning</h2>
                <p>Each algorithm has parameters to configure the algorithm. They are also known as <strong>hyperparameters</strong>.<br>
                  In order to get the best results, the best parameters for the given problem should be selected.
                </p>
              </li>
              <li>
                <div class="process step-3"></div>
                <h2>Training</h2>
                <p>After the optimal hyperparameters have been selected, we're ready to train the model.<br>
                  In this step, the algorithm creates the classifier model we can use for prediction.
                </p>
              </li>
              <li>
                <div class="process step-4"></div>
                <h2>Evaluation</h2>
                <p>The generated classifier model is then evaluated.<br>
                  The most used metric for determining the quality of the model is <strong>accuracy</strong>.
                  This measures how accurate it is in guessing the emotion, expressed in percentage.
                </p>
              </li>
            </ul>
          </div>
        </section>

        <!-- Slide #15 - Selected Algorithms -->
        <section>
          <div class="wrap">
            <h2 class="text-context">Algorithm Selection</h2>
            <ul class="flexblock border">
              <li>
                <h2>Extremely Randomized Trees</h2>
                <p>An ensemble of decision trees with really high randomness values when doing the splits.
                  They are usually more performant than the rest of the tree-based ensembles.
                  I found this to be the best algorithm for this problem. <br>
                  <strong>Accuracy: ~75% | 200 estimators</strong>
                </p>
              </li>
              <li>
                <h2>K-Nearest Neighbors</h2>
                <p>This algorithm memorizes the training data space.
                  For prediction, it places the data in that space.
                  Then the data's k-nearest neighbors vote on what class it is.
                  k is the user-defined neighbors, e.g. k=5 is 5 neighbors. <br>
                  <strong>Accuracy: ~70% | k=5</strong>
                </p>
              </li>
              <li>
                <h2>AdaBoost</h2>
                <p>AdaBoost creates a weak learner and makes a better version when it makes mistakes
                  until it reaches a certain user-defined point. <br>
                  <strong>Accuracy: ~60% | 500 estimators</strong>
                </p>
              </li>
              <li>
                <h2>Gradient Boosted Trees</h2>
                <p>The concept is similar to AdaBoost but the method of checking
                  whether it's getting better (loss function) is different.
                  Said to be better than AdaBoost.
                  This was a close contender to Extremely Randomized Trees. <br>
                  <strong>Accuracy: ~70% | 100 estimators</strong>
                </p>
              </li>
            </ul>
          </div>
        </section>

        <!-- Slide #18 - Save and Use Model -->
        <section class="bg-black aligncenter">
          <span class="background dark" style="background-image:url(images/pietro-jeng-266017.jpg)"></span>
          <div class="wrap">
            <h2 class="text-landing" style="font-size: 64pt;">Saving and using a model</h2>
            <hr>
            <h3>You can save models for later use.</h3>
            <h5>
              <code>joblib.dump(model, location)</code>
            </h5>
            <br>
            <h3>As you can expect, we can also load models.</h3>
            <h5>
              <code>model = joblib.load(location)</code>
            </h5>
            <br>
            <h3>After loading, we can now use the model.</h3>
            <h5>
              <code>prediction = model.predict(data)</code>
            </h5>
          </div>
        </section>

        <!-- Slide #20 - Demo -->
        <section class="bg-gradient-h">
          <div class="wrap aligncenter">
            <h1 class="text-landing" style="font-size: 64pt;">DEMO</h1>
          </div>
        </section>

        <!-- Slide #19 - Limitations && Improvements -->
        <section class="aligncenter">
          <div class="wrap">
            <div class="content-center">
              <h3 class="text-landing">Limitations and Improvements</h3>
              <ul class="flexblock specs">
                <li>
                  <div>
                      <h2>Lack of better features</h2>
                      <p>Better features like face meshes, contours, etc. would help the algorithm better understand how a certain facial expression is defined.</p>
                  </div>
                </li>
                <li>
                  <div>
                      <h2>Lack of training samples</h2>
                      <p>More samples will help increase the accuracy by giving the algorithm a better chance to figure out the pattern from your data.</p>
                  </div>
                </li>
                <li>
                  <div>
                      <h2>Lack of data variety</h2>
                      <p>More samples will help increase the accuracy by giving the algorithm a better chance to figure out the pattern from your data.</p>
                  </div>
                </li>
                <li>
                  <div>
                      <h2>Serial processing</h2>
                      <p>Parallel processing of all functions will make the program significantly faster.</p>
                  </div>
                </li>
                <li>
                  <div>
                      <h2>Not enough processing power</h2>
                      <p>Better processing power will allow us to use better algorithms like Convolutional Neural Networks.</p>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </section>

        <!-- Slide #20 - Q&A -->
        <section class="bg-gradient-h">
          <div class="wrap aligncenter">
            <h1 class="text-landing">Questions?</h1>
          </div>
        </section>

        <!-- Slide #21 - Thanks! -->
        <section class="bg-gradient-h">
          <div class="wrap aligncenter">
            <h1 class="text-landing">Thank You!</h1>
          </div>
        </section>
      </article>
    </main>

    <script src="static/js/webslides.js"></script>
    <script>
      window.ws = new WebSlides();
    </script>

    <!-- OPTIONAL - svg-icons.js (fontastic.me - Font Awesome as svg icons) -->
    <script defer src="static/js/svg-icons.js"></script>
  </body>
</html>